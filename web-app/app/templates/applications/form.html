{% extends "base.html" %}

{% block title %}{% if is_edit %}Edit{% else %}New{% endif %} Application - Job Tracker{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto">
    <!-- Back link -->
    <a href="/applications/" class="inline-flex items-center text-gray-600 dark:text-gray-400 hover:text-primary mb-6">
        <svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
        </svg>
        Back to applications
    </a>

    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border dark:border-gray-700 p-6">
        <h1 class="text-2xl font-bold text-gray-900 dark:text-white mb-6">
            {% if is_edit %}Edit Application{% else %}Add New Application{% endif %}
        </h1>

        <form method="POST" class="space-y-6">
            <!-- Company & Job Title -->
            <div class="grid md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                        Company <span class="text-red-500">*</span>
                    </label>
                    <input type="text" name="company" required
                           value="{{ application.company if application else '' }}"
                           class="w-full px-4 py-2 border dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"
                           placeholder="e.g., Google">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                        Job Title <span class="text-red-500">*</span>
                    </label>
                    <input type="text" name="job_title" required
                           value="{{ application.job_title if application else '' }}"
                           class="w-full px-4 py-2 border dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"
                           placeholder="e.g., Software Engineer">
                </div>
            </div>

            <!-- Location & URL -->
            <div class="grid md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Location</label>
                    <input type="text" name="location"
                           value="{{ application.location if application else '' }}"
                           class="w-full px-4 py-2 border dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"
                           placeholder="e.g., San Francisco, CA or Remote">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Job URL</label>
                    <input type="url" name="job_url"
                           value="{{ application.job_url if application else '' }}"
                           class="w-full px-4 py-2 border dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"
                           placeholder="https://...">
                </div>
            </div>

            <!-- Status & Date -->
            <div class="grid md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                    <select name="status"
                            class="w-full px-4 py-2 border dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                        {% for status in statuses %}
                        <option value="{{ status.value }}"
                                {% if application and application.status == status %}selected{% endif %}
                                {% if not application and status.value == 'applied' %}selected{% endif %}>
                            {{ status.value|capitalize }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Applied Date</label>
                    <input type="date" name="applied_date"
                           value="{{ application.applied_date.strftime('%Y-%m-%d') if application else '' }}"
                           class="w-full px-4 py-2 border dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                </div>
            </div>

            <!-- Salary Range -->
            <div class="grid md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Salary Min ($)</label>
                    <input type="number" name="salary_min"
                           value="{{ application.salary_min if application and application.salary_min else '' }}"
                           class="w-full px-4 py-2 border dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"
                           placeholder="e.g., 100000">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Salary Max ($)</label>
                    <input type="number" name="salary_max"
                           value="{{ application.salary_max if application and application.salary_max else '' }}"
                           class="w-full px-4 py-2 border dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"
                           placeholder="e.g., 150000">
                </div>
            </div>

            <!-- Resume -->
            {% if resumes %}
            <div>
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Resume Used</label>
                <select name="resume_id"
                        class="w-full px-4 py-2 border dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                    <option value="">-- Select Resume --</option>
                    {% for resume in resumes %}
                    <option value="{{ resume.id }}"
                            {% if application and application.resume_id == resume.id %}selected{% endif %}>
                        {{ resume.name }}{% if resume.is_default %} (Default){% endif %}
                    </option>
                    {% endfor %}
                </select>
            </div>
            {% endif %}

            <!-- Notes -->
            <div>
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Notes</label>
                <textarea name="notes" rows="4"
                          class="w-full px-4 py-2 border dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"
                          placeholder="Interview notes, contact info, reminders...">{{ application.notes if application else '' }}</textarea>
            </div>

            <!-- Job Description -->
            <div>
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Job Description</label>
                <textarea name="job_description" rows="6"
                          class="w-full px-4 py-2 border dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"
                          placeholder="Paste job description here...">{{ application.job_description if application else '' }}</textarea>
            </div>

            <!-- Submit -->
            <div class="flex items-center justify-end gap-4 pt-4">
                <a href="/applications/" class="px-4 py-2 text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white">Cancel</a>
                <button type="submit"
                        class="px-6 py-2 bg-primary text-white rounded-lg hover:bg-blue-600 transition-colors">
                    {% if is_edit %}Save Changes{% else %}Add Application{% endif %}
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}
